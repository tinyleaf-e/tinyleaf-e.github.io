(function(){"use strict";var t={1225:function(t,e,a){var r=a(7332),s=a.n(r),o=a(1722),n=a.n(o),i=a(9087),c=a.n(i),l=a(1017),d=a.n(l),u=a(9983),f=a.n(u),p=a(7393),v=a.n(p),h=a(4837),m=a.n(h),g=a(1987),_=a.n(g),S=a(4247),C=a.n(S),y=a(7579),D=a.n(y),b=a(2856),x=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"body"},["today"===t.activeItem?e("CurrentDay"):t._e(),"history"===t.activeItem?e("HistoryRecord"):t._e(),"profile"===t.activeItem?e("UserProfile"):t._e()],1),e("div",{staticClass:"footer",on:{click:t.triggerHiddenMenu}},[e("div",{staticClass:"item",attrs:{active:"today"===t.activeItem},on:{click:function(e){t.activeItem="today"}}},[t._m(0),t._v("今天")]),e("div",{staticClass:"item",attrs:{active:"history"===t.activeItem},on:{click:function(e){t.activeItem="history"}}},[t._m(1),t._v("回顾")]),t.showHiddenMenu?e("div",{staticClass:"item",attrs:{active:"profile"===t.activeItem},on:{click:function(e){t.activeItem="profile"}}},[t._m(2),t._v("我")]):t._e()])])},w=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"icon"},[e("i",{staticClass:"el-icon-medal"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"icon"},[e("i",{staticClass:"el-icon-s-order"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"icon"},[e("i",{staticClass:"el-icon-user"})])}],M=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{height:"100%",overflow:"hidden"}},[e("div",{staticClass:"title fixed"},[t._v("今日计分")]),e("div",{staticClass:"score-operation-box fixed"},[e("el-carousel",{attrs:{type:"card",height:"200px",arrow:"never",autoplay:!1},on:{change:t.handleCarouselChange}},[e("el-carousel-item",[e("div",{staticClass:"score-btn plus",attrs:{scale:0!==t.currentCarouselIdx},on:{click:function(e){return t.showScoreDialog("plus")}}},[e("div",{staticClass:"backcolor wave plus"}),e("div",{staticClass:"text-info"},[e("div",{staticClass:"score-count"},[e("span",{staticClass:"desc"},[t._v("今日总计")]),e("span",{staticClass:"score plus"},[t._v(t._s(`+${t.positiveScoreSum}`))]),e("span",{staticClass:"unit"},[t._v("分")])]),e("div",{staticClass:"score plus"},[t._v("点击+1")])])])]),e("el-carousel-item",[e("div",{staticClass:"score-btn minus",attrs:{scale:1!==t.currentCarouselIdx},on:{click:function(e){return t.showScoreDialog("minus")}}},[e("div",{staticClass:"backcolor wave minus"}),e("div",{staticClass:"text-info"},[e("div",{staticClass:"score-count"},[e("span",{staticClass:"desc"},[t._v("今日总计")]),e("span",{staticClass:"score minus"},[t._v(t._s("-"+-t.negativeScoreSum))]),e("span",{staticClass:"unit"},[t._v("分")])]),e("div",{staticClass:"score minus"},[t._v("点击-1")])])])])],1)],1),e("div",{staticClass:"holder"}),e("div",{staticClass:"score-detail-box"},t._l(t.recordData,(function(a,r){return e("div",{key:r,staticClass:"score-item"},[e("div",{staticClass:"score",attrs:{type:a.score>0?"plus":"minus"}},[t._v(" "+t._s(`${a.score>0?"+":""}${a.score}`)+" ")]),e("div",{staticClass:"detail"},[e("div",[e("el-tag",{attrs:{size:"mini",type:a.score>0?"":"danger"}},[t._v(t._s(a.reason))])],1),e("div",{staticClass:"time"},[e("span",[t._v(t._s(t.formatDateTime(t.formatDateStrFromUTC(a.create_time))))]),e("span",{staticClass:"ago"},[t._v(t._s(t.timeAgo(t.formatDateStrFromUTC(a.create_time))))])])])])})),0),e("el-dialog",{attrs:{visible:t.dialogVisible,"show-close":!1,width:"80%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[t.dialogVisible?e("AddScoreRecord",{staticStyle:{"margin-top":"-25px"},attrs:{"score-type":t.currentScoreType},on:{added:t.handleScoreAdded}}):t._e()],1)],1)},$=[],k=a(1232),T=a.n(k),O=a(417);function A(){return localStorage.id}function I(t,e=!0){const a=O.A.create({baseURL:{NODE_ENV:"production",BASE_URL:""}.VUE_APP_BASE_API,timeout:5e5,withCredentials:!0});return a.interceptors.request.use((t=>(t.headers["userid"]=A(),t)),(t=>(console.log(t),Promise.reject(t)))),a.interceptors.response.use((t=>{const a=t.data;try{a.data&&void 0!==a.data.total&&void 0!==a.data.items&&("string"===typeof a.data.total&&/^[0-9]+$/.test(a.data.total)&&(a.data.total=parseInt(a.data.total,10)),0===a.data.total&&(a.data.items=[]))}catch(r){console.log("error when process response:",r)}return 0!==a.code&&0!==a.state.code&&e?(s()({message:a.state.msg||"Error",type:"error",duration:5e3}),50008!==a.state.code&&50012!==a.state.code&&50014!==a.state.code||T().confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then((()=>{})),Promise.reject(new Error(a.state.msg||"Error"))):a}),(t=>(console.log(`err${t}`),s()({message:t.message,type:"error",duration:5e3}),Promise.reject({code:-1})))),a(t)}var R=I;let U="http://localhost:9000";function j(t){return R({baseURL:U,url:"/getScoreOfDay",method:"get",params:t})}function P(t){return R({baseURL:U,url:"/addScore",method:"post",data:t})}function E(t){return R({baseURL:U,url:"/getScoreSumOfCurrentMonth",method:"get",params:t})}function F(t){return R({baseURL:U,url:"/searchScoreReasonsByCount",method:"get",params:t})}U="https://1252077373-hz6o1j8fiy.ap-beijing.tencentscf.com";var H=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"title"},[t._v(t._s(("plus"===t.scoreType?"+":"-")+"1分"))]),e("div",[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"选择或输入加分事由"},model:{value:t.reason,callback:function(e){t.reason=e},expression:"reason"}},t._l(t.reasonOptions,(function(a){return e("el-option",{key:a.value,attrs:{label:a.label,value:a.reason}},[e("div",{staticClass:"reason-option"},[e("div",[e("span",[t._v(t._s(a.reason))])]),e("div",{staticClass:"info"},[e("span",[t._v(t._s(`使用${a.count}次`))]),e("span",{staticStyle:{"margin-left":"6px"}},[t._v(t._s(`${t.timeAgo(t.formatDateStrFromUTC(a.latest_create_time))}使用`))])])])])})),1)],1),e("el-button",{staticClass:"btn",attrs:{type:"primary",plain:""},on:{click:t.addRecord}},[t._v("确认")])],1)},V=[];function B(t){t=new Date(t);const e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),n=String(t.getSeconds()).padStart(2,"0");return`${e}-${a}-${r} ${s}:${o}:${n}`}function L(t){t=new Date(t);const e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${a}-${r}`}function z(t){t=new Date(t);const e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0");return`${e}-${a}`}function Y(t){t=new Date(t);const e=new Date,a=Math.floor((e-t)/1e3);if(a<60)return`${a}秒前`;const r=Math.floor(a/60);if(r<60)return`${r}分钟前`;const s=Math.floor(r/60);if(s<24)return`${s}小时前`;const o=Math.floor(s/24);if(o<30)return`${o}天前`;const n=Math.floor(o/30);if(n<12)return`${n}个月前`;const i=Math.floor(n/12);return`${i}年前`}function N(t){const e=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/,a=t.match(e);if(a){const t=a[1],e=a[2],r=a[3],s=a[4],o=a[5],n=a[6];return`${t}-${e}-${r} ${s}:${o}:${n}`}return""}var q={name:"AddScoreRecord",props:{scoreType:{type:String}},data(){return{reason:"",reasonOptions:[]}},mounted(){this.searchScoreReasonsByCount()},methods:{formatDateTime:B,timeAgo:Y,formatDateStrFromUTC:N,addRecord(){P({score:"plus"===this.scoreType?1:-1,reason:this.reason}).then((t=>{0===t.code?this.$message({message:"plus"===this.scoreType?"成功添加！每天都有新进步哦~":"添加记录，不要灰心呀~",type:"success"}):this.$message("error"),this.$emit("added")})).catch((t=>{console.log(t)}))},searchScoreReasonsByCount(){F({score_type:"plus"===this.scoreType?1:-1}).then((t=>{console.log(t),this.reasonOptions=t.data})).catch((t=>{console.log(t)}))}}},G=q,J=a(1656),K=(0,J.A)(G,H,V,!1,null,"0ee8b7ba",null),Q=K.exports,W={name:"CurrentDay",components:{AddScoreRecord:Q},props:[{name:"fd"}],data(){return{recordData:[],dialogVisible:!1,currentScoreType:"plus",currentCarouselIdx:0}},computed:{positiveScoreSum(){return this.recordData.reduce(((t,e)=>t+(e.score>0?e.score:0)),0)},negativeScoreSum(){return this.recordData.reduce(((t,e)=>t+(e.score<0?e.score:0)),0)}},mounted(){this.getScoreOfDay()},methods:{formatDateTime:B,timeAgo:Y,formatDateStrFromUTC:N,getScoreOfDay(){j({date:L(new Date)}).then((t=>{console.log(t),this.recordData=t.data.reverse()})).catch((t=>{console.log(t)}))},showScoreDialog(t){t===this.currentScoreType&&(this.dialogVisible=!0),this.currentScoreType=t},handleCarouselChange(t){this.currentCarouselIdx=t},handleScoreAdded(){this.getScoreOfDay(),this.dialogVisible=!1}}},X=W,Z=(0,J.A)(X,M,$,!1,null,"20ab7962",null),tt=Z.exports,et=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"title fixed"},[t._v("本月回顾")]),e("div",{staticClass:"holder"}),e("div",{staticClass:"context"},[e("el-calendar",{scopedSlots:t._u([{key:"dateCell",fn:function({date:a}){return[e("div",{staticClass:"score-cell"},[t.recordDataMap[t.formatDate(a)]?e("div",{staticClass:"background-indicator plus",style:{height:100*t.clamp(t.recordDataMap[t.formatDate(a)].positive_score/t.expectedScore,.01,1)+"%"}}):t._e(),t.recordDataMap[t.formatDate(a)]?e("div",{staticClass:"background-indicator minus",style:{height:100*t.clamp(-t.recordDataMap[t.formatDate(a)].negative_score/t.expectedScore,.01,1)+"%"}}):t._e(),e("div",{staticClass:"date"},[t._v(t._s(a.getDate()))]),t.recordDataMap[t.formatDate(a)]?e("div",[e("div",{staticClass:"detail plus"},[t._v("+"),e("span",[t._v(t._s(t.recordDataMap[t.formatDate(a)].positive_score))])]),e("div",{staticClass:"detail minus"},[t._v("- "),e("span",[t._v(t._s(-t.recordDataMap[t.formatDate(a)].negative_score))])])]):t._e()])]}}]),model:{value:t.calendarDate,callback:function(e){t.calendarDate=e},expression:"calendarDate"}})],1)])},at=[],rt={name:"HistoryRecord",data(){return{calendarDate:new Date,recordData:[],lastDate:"",expectedScore:15}},mounted(){this.getScoreSumOfCurrentMonth(L(new Date))},computed:{recordDataMap(){return this.recordData.reduce(((t,e)=>(t[L(e.date)]={positive_score:e.positive_score,negative_score:e.negative_score},t)),{})}},watch:{calendarDate(t){z(t)!==z(this.lastDate)&&this.getScoreSumOfCurrentMonth(L(t))}},methods:{formatDateTime:B,timeAgo:Y,formatDate:L,getScoreSumOfCurrentMonth(t){this.lastDate=t,E({date:t}).then((t=>{console.log(t),this.recordData=t.data})).catch((t=>{console.log(t)}))},clamp(t,e,a){return Math.min(Math.max(t,e),a)}}},st=rt,ot=(0,J.A)(st,et,at,!1,null,"6f41797e",null),nt=ot.exports;function it(t){t=t||16;let e="abcdefhijkmnprstwxyz2345678",a=e.length,r="";for(let s=0;s<t;s++)r+=e.charAt(Math.floor(Math.random()*a));return r}function ct(t,e){t=Math.max(parseInt(t),0)||5,e=Math.max(parseInt(e),0)||5;let a=new Array(t).fill(new Date(0)),r=0;return{add(){a[r++%t]=new Date},ok(){return new Date-a[(r+1)%t]<1e3*e}}}var lt=a(2882),dt=a.n(lt),ut=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{padding:"20px"}},[e("div",{staticStyle:{height:"60px","line-height":"60px","font-size":"26px","text-align":"center"}},[t._v("个人信息")]),e("div",[e("el-input",{staticStyle:{width:"100%"},model:{value:t.user,callback:function(e){t.user=e},expression:"user"}})],1),e("div",[e("el-button",{staticStyle:{width:"100%","margin-top":"20px"},on:{click:t.editUser}},[t._v("修改")])],1),e("div",{staticStyle:{"margin-top":"20px",color:"red"}},[t._v("用于不同浏览器间的数据迁移，修改完成后刷新页面即可，谨慎操作")])])},ft=[],pt={name:"UserProfile",data(){return{user:""}},created(){this.user=localStorage.id},methods:{editUser(){localStorage.id=this.user,dt().set("score_record_user",this.user),this.$message({message:"修改成功，请刷新页面",type:"success"})}}},vt=pt,ht=(0,J.A)(vt,ut,ft,!1,null,"5d4532dd",null),mt=ht.exports,gt={name:"App",components:{UserProfile:mt,HistoryRecord:nt,CurrentDay:tt},data(){return{activeItem:"today",hiddenMenuCounter:{},showHiddenMenu:!1}},created(){dt().set("score_record_user",this.getID()),this.hiddenMenuCounter=ct(5,2)},methods:{getID(){if(localStorage.id)return localStorage.id;{let t=it();return localStorage.id=t,t}},triggerHiddenMenu(){this.hiddenMenuCounter.ok()?this.showHiddenMenu=!0:this.hiddenMenuCounter.add()}}},_t=gt,St=(0,J.A)(_t,x,w,!1,null,"27ce0826",null),Ct=St.exports;b["default"].config.productionTip=!1,b["default"].use(D()),b["default"].use(C()),b["default"].use(_()),b["default"].use(m()),b["default"].use(v()),b["default"].use(f()),b["default"].use(d()),b["default"].use(c()),b["default"].use(n()),b["default"].prototype.$message=s(),new b["default"]({render:t=>t(Ct)}).$mount("#app")}},e={};function a(r){var s=e[r];if(void 0!==s)return s.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,a),o.exports}a.m=t,function(){var t=[];a.O=function(e,r,s,o){if(!r){var n=1/0;for(d=0;d<t.length;d++){r=t[d][0],s=t[d][1],o=t[d][2];for(var i=!0,c=0;c<r.length;c++)(!1&o||n>=o)&&Object.keys(a.O).every((function(t){return a.O[t](r[c])}))?r.splice(c--,1):(i=!1,o<n&&(n=o));if(i){t.splice(d--,1);var l=s();void 0!==l&&(e=l)}}return e}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[r,s,o]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={524:0};a.O.j=function(e){return 0===t[e]};var e=function(e,r){var s,o,n=r[0],i=r[1],c=r[2],l=0;if(n.some((function(e){return 0!==t[e]}))){for(s in i)a.o(i,s)&&(a.m[s]=i[s]);if(c)var d=c(a)}for(e&&e(r);l<n.length;l++)o=n[l],a.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return a.O(d)},r=self["webpackChunkscore_record_frontend"]=self["webpackChunkscore_record_frontend"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=a.O(void 0,[504],(function(){return a(1225)}));r=a.O(r)})();
//# sourceMappingURL=app.99824b59.js.map